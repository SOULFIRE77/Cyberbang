<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cyberbang</title>
  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.webmanifest">
  <!-- favicon -->
  <link rel="icon" href="icons/icon-192.png" type="image/png">
  <meta name="theme-color" content="#00ffff">
  <!-- Подключение TonConnect UI -->
  <script src="tonconnect-ui.js"></script>
  <style>
    body {
      margin: 0;
      background: #0d0d0d;
      color: #00ffcc;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    h1 {
      margin-top: 40px;
      font-size: 2.5em;
    }
    .btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1.2em;
      background: #00ffcc;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn:hover {
      background: #00e6b3;
    }
  </style>
</head>
<body>
  <h1>Добро пожаловать в Cyberbang!</h1>

  <!-- Тестовый вывод favicon-пути через <img> -->
  <p>Тестовая иконка ниже (если видно — путь корректен):</p>
  <img src="icons/icon-192.png" alt="Icon Test" style="width:64px; height:64px;">

  <!-- Контейнер для кнопки подключения TON-кошелька -->
  <div id="ton-connect"></div>
  <!-- Отображение подключённого адреса -->
  <div id="wallet-address" style="margin-top: 15px;"></div>
  <!-- Инструкция для регистрации в Telegram-боте -->
  <div id="register-instructions" style="margin-top: 10px; color: #00ffcc;"></div>
  <a id="bot-link" href="#" target="_blank" style="display:none;">
    <button class="btn">Зарегистрировать адрес в боте</button>
  </a>

  <!-- Скрипт инициализации TonConnect и обработка подключения -->
  <script>
    // Инициализация TonConnect UI
    const tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
      manifestUrl:https://github.com/SOULFIRE77/cyberbang/blob/main/tonconnect-manifest.json, // замени на свой URL
      buttonRootId: "ton-connect"
    });

    // Функция обработки подключения кошелька
    async function onWalletConnected(provider) {
      try {
        const account = (await provider.getAccount())?.account;
        if (account) {
          document.getElementById("wallet-address").innerText =
            "Подключен адрес: " + account;
          // Инструкция для Telegram-бота
          const instrEl = document.getElementById("register-instructions");
          instrEl.innerHTML = `Скопируйте команду:<br><code>/register ${account}</code>`;
          const botLink = document.getElementById("bot-link");
          botLink.href = "https://t.me/CyberBangBOT"; // замените на юзернейм вашего бота
          botLink.style.display = "inline-block";
        }
      } catch (err) {
        console.error("Ошибка при получении адреса:", err);
      }
    }

    // Слушаем изменение статуса TonConnect
    tonConnectUI.onStatusChange(async (wallet) => {
      if (wallet.connected) {
        const provider = await tonConnectUI.connect();
        await onWalletConnected(provider);
      }
    });
  </script>
</body>
</html>
